extends ../layouts/admin-layout.pug
block styles
    link(href="/plugins/jquery-datatable/skin/bootstrap/css/dataTables.bootstrap.css" rel="stylesheet")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer")

block content
    if(action!=="undefined" && action==="create")
        .alert.alert-success.alert-dismissible.fade.show(role='alert')
            strong Ürün Başarılı Bir Şekilde Eklendi
    if(action!=="undefined" && action==="delete")
        .alert.alert-warning.alert-dismissible.fade.show(role='alert')
            strong Ürün Başarılı Bir Şekilde Silindi
    if(action!=="undefined" && action==="edit")
        .alert.alert-info.alert-dismissible.fade.show(role='alert')
            strong Ürün Ayarları Başarılı Bir Şekilde Güncellendi

        
    script.
        window.setTimeout(function() {
            $(".alert").fadeTo(500, 0).slideUp(500, function(){
                $(this).remove(); 
            });
        }, 2000);
    
    .row.clearfix
        .col-lg-12.col-md-12.col-sm-12.col-xs-12
            
            .card
                
                a(href="/admin/add-product").btn.btn-primary.btn-sm
                    span 
                        i.fas.fa-plus.fa-xs.mr-2
                    | Yeni Ürün Ekleme

                if products.length > 0
                        
                    .body
                        .table-responsive
                            table.table.table-bordered.table-striped.table-hover.dataTable.js-exportable.text-center
                                thead
                                    tr
                                        th Ürün Resmi
                                        th Ürün Adı
                                        th Ürün Fiyatı
                                        th Yazar
                                        th Tarih
                                        th Aktif
                                        th Popüler
                                        th
                                            

                                tfoot
                                    tr
                                        th Ürün Resmi
                                        th Ürün Adı
                                        th Ürün Fiyatı
                                        th Yazar
                                        th Tarih
                                        th Aktif
                                        th Popüler
                                        th
                                tbody
                                    each product in products                
                                        tr
                                            td 
                                                img(src=`/img/${product.imageUrl}` width='80')
                                            td.align-middle #{product.name}
                                            td.align-middle #{product.price} TL
                                            td.align-middle #{product.userId.name}
                                            td.align-middle #{product.date.getDate()+"/"+product.date.getMonth()+"/"+product.date.getFullYear()}
                                                br
                                                |#{product.date.getHours()+":"+ product.date.getMinutes()}
                                            td.align-middle 
                                                button.btn.p-2(style="border-radius:50%;" class=(product.isActive ? "btn-success" : "btn-danger"))
                                            td.align-middle 
                                                button.btn.p-2(style="border-radius:50%;" class=(product.popular ? "btn-success" : "btn-danger"))
                                            td.align-middle.position-relative
                                                a.btn.btn-warning.btn-sm(href=`/admin/products/${product._id}`) 
                                                    span 
                                                        i.fas.fa-edit.fa-xs
                                                form(action="/admin/delete-product" method="POST")
                                                    input(type="hidden" name="_csrf" value=`${csrfToken}`)  
                                                    input(type="hidden" name="productid" value=`${product._id}`)
                                                    button(type="submit" style="height:40px; width:40px;").btn.btn-danger.btn-sm
                                                        span 
                                                            i.fas.fa-trash-alt.fa-xs
                else
                    p.text-center.align-middle Herhangi Bir Ürün Mevcut Değil
block script    
    script(src="/plugins/jquery-datatable/jquery.dataTables.js")
    script(src="/plugins/jquery-datatable/skin/bootstrap/js/dataTables.bootstrap.js")
    script(src="/plugins/jquery-datatable/extensions/export/dataTables.buttons.min.js")
    script(src="/plugins/jquery-datatable/extensions/export/buttons.flash.min.js")
    script(src="/plugins/jquery-datatable/extensions/export/jszip.min.js")
    script(src="/plugins/jquery-datatable/extensions/export/pdfmake.min.js")
    script(src="/plugins/jquery-datatable/extensions/export/vfs_fonts.js")
    script(src="/plugins/jquery-datatable/extensions/export/buttons.html5.min.js")
    script(src="/plugins/jquery-datatable/extensions/export/buttons.print.min.js")
    script(src='/js/pages/tables/jquery-datatable.js')
